mapchart=function(){var t=window.location.pathname.split("/"),i=t[t.length-1].split(".")[0],Z=window.location.hostname.replace("www",""),J={},l=[],g=0,W=!0,o="#d1dbdd",n=["world-1815","world-1880","world-1914","world-1938","world-cold-war","oceania-detailed","asia-detailed","africa-detailed","americas-detailed","detworld","usa-counties","russia","world","europe-detailed","usa-congressional-districts","canada-census-divisions","france-departments"],s={},c=[["f7fcfd","e5f5f9","ccece6","99d8c9","66c2a4","41ae76","238b45","006d2c","00441b"],["f7fcfd","e0ecf4","bfd3e6","9ebcda","8c96c6","8c6bb1","88419d","810f7c","4d004b"],["f7fcf0","e0f3db","ccebc5","a8ddb5","7bccc4","4eb3d3","2b8cbe","0868ac","084081"],["fff7ec","fee8c8","fdd49e","fdbb84","fc8d59","ef6548","d7301f","b30000","7f0000"],["fff7fb","ece7f2","d0d1e6","a6bddb","74a9cf","3690c0","0570b0","045a8d","023858"],["ffffe5","f7fcb9","d9f0a3","addd8e","78c679","41ab5d","238443","006837","004529"],["ffffcc","ffeda0","fed976","feb24c","fd8d3c","fc4e2a","e31a1c","bd0026","800026"],["ffffff","f0f0f0","d9d9d9","bdbdbd","969696","737373","525252","252525","000000"],["8c510a","bf812d","dfc27d","f6e8c3","f5f5f5","c7eae5","80cdc1","35978f","01665e"],["b2182b","d6604d","f4a582","fddbc7","f7f7f7","d1e5f0","92c5de","4393c3","2166ac"],["d73027","f46d43","fdae61","fee090","ffffbf","e0f3f8","abd9e9","74add1","4575b4"],["a6cee3","1f78b4","b2df8a","33a02c","fb9a99","e31c2c","fdbf6f","ff7f00","cab2d6"],["fbb4ae","e41a1c","377eb8","4daf4a","984ea3","ff2000","ffff33","a65628","999999"],["8dd3c7","ffffb3","bebada","fb8072","80b1d3","fdb462","b3de69","fccde5","ffa07a"],["71c671","388e8e","7d9ec0","7171c6","8e388e","8e8e38","00c957","cc3333","d1dbdd"]],Q=['<pattern id="circles3" width="10" height="10" patternUnits="userSpaceOnUse">            <rect width="10" height="10" fill="#fff" />            <circle cx="4" cy="4" r="2" fill="#000"/>        </pattern>','<pattern id="diagonal1" width="10" height="10" patternUnits="userSpaceOnUse">            <rect width="10" height="10" fill="#fff"/>            <path d="M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2" stroke="#000" stroke-width="1"/>        </pattern>','<pattern id="diagonal3" width="10" height="10" patternUnits="userSpaceOnUse">            <rect width="10" height="10" fill="#fff"/>            <path d="M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2" stroke="#000" stroke-width="3"/>        </pattern>','<pattern id="vertical1" width="10" height="10" patternUnits="userSpaceOnUse">            <rect width="10" height="10" fill="#fff" />            <rect x="3" y="0" width="1" height="10" fill="#000" />        </pattern>','<pattern id="vertical3" width="10" height="10" patternUnits="userSpaceOnUse">            <rect width="10" height="10" fill="#fff" />            <rect x="3" y="0" width="3" height="10" fill="#000" />        </pattern>','<pattern id="horizontal1" width="10" height="10" patternUnits="userSpaceOnUse">            <rect width="10" height="10" fill="#fff" />            <rect x="0" y="4" width="10" height="1" fill="#000" />        </pattern>','<pattern id="horizontal3" width="10" height="10" patternUnits="userSpaceOnUse">            <rect width="10" height="10" fill="#fff" />            <rect x="0" y="4" width="10" height="3" fill="#000" />        </pattern>','<pattern id="crosshatch" width="8" height="8" patternUnits="userSpaceOnUse">            <rect width="8" height="8" fill="#fff"/>            <path d="M0 0L8 8ZM8 0L0 8Z" stroke-width="0.5" stroke="#aaa"/>        </pattern>','<pattern id="subtlepatch" width="5" height="5" patternUnits="userSpaceOnUse">            <rect width="5" height="5" fill="#fff" />            <rect x="2" y="2" width="1" height="1" fill="#000" />        </pattern>','<pattern id="checkers" width="8" height="8" patternUnits="userSpaceOnUse">            <rect width="8" height="8" fill="#fff"/>            <path fill="#000" fill-rule="evenodd" d="M0 0h4v4H0V0zm4 4h4v4H4V4z"/>        </pattern>','<pattern id="raindrops" width="10" height="10" patternUnits="userSpaceOnUse">            <rect width="10" height="10" fill="#fff"/>            <path fill="#000" d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z"/>        </pattern>','<pattern id="texture" width="4" height="4" patternUnits="userSpaceOnUse">            <rect width="4" height="4" fill="#fff"/>            <path fill="#000" d="M1 3h1v1H1V3zm2-2h1v1H3V1z"></path>        </pattern>'];function u(t,e,a){return t+"_"+e.replace("#","")+"_"+a.replace("#","")}function Y(t){return"url(#"+t+")"}function d(t){return-1!==t.indexOf("url")}function f(t){var e=t.split("_");return{pType:e[0],bg:"#"+e[1],top:"#"+e[2]}}function h(t){var e=$("#"+t).attr("fill");if(d(e)){var a=e.match(/\(#([^)]+)\)/)[1].split("_");return{pType:a[0],bg:"#"+a[1],top:"#"+a[2]}}return{pType:"circles3",bg:e=X(e),top:"#000000"}}function m(t){var e=$("#"+t).attr("fill");return d(e)?e.match(/\(#([^)]+)\)/)[1]:X(e)}function p(t,e,a){var r=u(t=t||$(".selectedPattern select").val(),e=e||$("#bgPatternPicker").spectrum("get").toString(),a=a||$("#topPatternPicker").spectrum("get").toString()),i=$("#"+t).clone().prop({id:r});i.children()[0].setAttribute("fill",e),-1===["diagonal1","diagonal3","crosshatch"].indexOf(t)?i.children()[1].setAttribute("fill",a):i.children()[1].setAttribute("stroke",a),$("#previewPatternSVG defs").append(i),$("#previewPatternSVG .previewPatternRect").attr("fill",Y(r))}function b(t,e,a,r){$("#undo-clear").hide("slow");var i=t[0].id;if(P(i)){var n=m(i),l=$(".previewPatternRect").attr("fill"),o=u(e,a,r),s=$("#"+o).clone();$("#map defs").append(s),Q.push(s.outerHTML()),t.attr("fill",l).css("fill",l);var c,d,f,h,p=(c=$("#"+o),d=c.html().replace(/\s\s+/g," "),f=c.attr("width"),h=c.attr("height"),'url("data:image/svg+xml;base64,'+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="'+f+'" height="'+h+'">'+d+"</svg>")+'")');if(o in J)J[o].count++,J[o].paths.push(i);else{$("#legendplace").append('<tr><td> <div data-patternId="'+o+'" class="legend-box" id="box'+g+'"> </div> </td><td> <input type="text" class="form-control" tabindex='+g+'1 id="label'+g+'" style="height:20px; width:100%;"> </input> </td><td style="text-align:center"> <button  class="btn btn-new btn-newC btn-xs" type="button" onclick="mapchart.deleteRow(this)" ><i class="fa fa-times"></i></button></td></tr>');$("#legendplace>tr:last-child>td:first-child>div").css({"background-image":p,"background-repeat":"repeat"}),J[o]={count:1,div:"#box"+g,paths:[i]},g++}_(n,i)}}function v(t,e,a,r){var i=t[0].id,n=m(i),l=u(e,a,r),o=Y(l);t.attr("fill",o).css("fill",o),J[l].count++,J[l].paths.push(i),_(n,i)}function w(t,e){if(t in J)J[t].count++,J[t].paths.push(e);else{$("#legendplace").append('<tr><td> <div class="legend-box" id="box'+g+'" title="Click to change the color of this group."> </div> </td><td> <input type="text" class="form-control" tabindex='+g+'1 id="label'+g+'" style="height:20px; width:100%;"> </input> </td><td style="text-align:center"> <button  class="btn btn-new btn-newC btn-xs" type="button" onclick="mapchart.deleteRow(this)" ><i class="fa fa-times"></i></button></td></tr>');$("#legendplace>tr:last-child>td:first-child>div").css({"background-color":t}),J[t]={count:1,div:"#box"+g,paths:[e]},$("#box"+g).spectrum({color:t,showInput:!0,showPalette:!0,palette:c,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,containerClassName:"box"+g+"-container",preferredFormat:"hex",change:function(t){var e=X($(this).css("background-color")),a=t;$(this).css("background-color",a),$("#fillpicker").spectrum("set",a),J[e].paths.forEach(function(t){$("#"+t).attr("fill",a).css("fill",a)}),J[a]={count:J[e].count,div:"#"+$(this).attr("id"),paths:J[e].paths},delete J[e]},show:function(t){for(var e in J)$("."+this.id+'-container .sp-palette-container span.sp-thumb-el[title="'+e+'"]').addClass("sp-thumb-active")}}),g++}}function k(t){$("#undo-clear").hide("slow");var e=t[0].id;if(P(e)){var a=t[0].style;if(d(a.fill)){var r=$("#info").css("background-color");return $("#info").html("Please Right-click -> Remove Pattern first.").css("background-color","#ff2000"),void setTimeout(function(){$("#info").css("background-color",r)},1e3)}-1!==l.indexOf(e)&&(a.strokeDasharray="none",l.splice(l.indexOf(e),1));var i=""===a.fill?o:X(a.fill),n=$("#fillpicker").spectrum("get");t.attr("fill",n).css("fill",n),$("#no-borders").is(":checked")||(a.stroke=n),w(n,e),_(i,e)}}function y(t){var e=t[0].style,a=t[0].id,r=m(a);t.attr("fill","#ffffff").css("fill","#ffffff"),e.strokeDasharray="1, 5",l.push(a),_(r,a)}function x(){s=C(),$("#map>path").each(function(){P(this.id)&&$(this).attr("fill",o).css({fill:o,stroke:"rgb(0,0,0)","stroke-dasharray":"none"})});var t=document.getElementById("canvas1");t.getContext("2d").clearRect(0,0,t.width,t.height),O(),$("#ltable").html('<thead><tr><th>Color</th> <th id="description"> Label</th> <th> Remove </th> </tr></thead><tbody id="legendplace"></tbody>'),W||$("#ltable").css("opacity",.3),$("#legendplace").sortable(),$("#map").css("background-color","white"),$("#edit").prop("disabled",!0),$("#convert, #clear, #downup").prop("disabled",!1),$("#undo-clear").toggle("slow"),J={},l=[],g=0}function P(t){var e=!0;return-1!==["State_borders","sidemap","state_abbr","state_lines","terr_name","Department_Names","Prefecture_Names","Cities","split_UK_label","United_Kingdom_label"].indexOf(t)&&(e=!1),e}function S(t){var e=t[0].style,a=t[0].id;if(""===e.fill)return!1;var r=X(e.fill);r!==o&&(e.fill=o,t.attr("fill",o),$("#no-borders").is(":checked")||(e.stroke=o),_(r,a))}function _(t,e){if(t in J){J[t].count--;var a=J[t].paths.indexOf(e);J[t].paths.splice(a,1),0===J[t].count&&r(t)}}function O(){var t=parseInt($("#canvas1").attr("height"))/parseInt($("#map").attr("height").match(/\d+/)[0]),e=conf.originalSVGH*t;$("#canvas1").attr("height",e),$("#map").attr("height",conf.originalSVGH)}function r(t){var e=J[t].div;$(e).parent().parent().remove(),delete J[t]}function C(){var t={groups:{},title:$("#mapTitleInput").val(),hidden:l,borders:$("#borderpicker").spectrum("get").toString()};for(var e in J){var a=J[e].div,r=a.match(/\d/g);r=r.join(""),t.groups[e]={div:a,label:$("#label"+r).val(),paths:J[e].paths}}return JSON.stringify(t)}function L(t){$("#mapTitleInput").val(t.title),$("#map>path").each(function(){P(this.id)&&$(this).css("stroke",t.borders)});var e=0;for(var a in t.groups){for(var r=t.groups[a].paths,i=0,n=r.length;i<n;i++){var l=r[i];if(P(l=I(l)))if(7!==a.length){var o=f(a);p(o.pType,o.bg,o.top),b($("#"+l),o.pType,o.bg,o.top)}else $("#"+l).attr("fill",a).css("fill",a),w(a,l)}$("#label"+e).val(t.groups[a].label),e++}if(t.hidden)for(var s=t.hidden,c=0,d=s.length;c<d;c++)y($("#"+s[c]))}function I(t){var e={Orandge__FL:"Orange__FL",Monacco:"Monaco",McKinely__NM:"McKinley__NM",Shannon__SD:"Oglala_Lakota__SD",Lichtenstein:"Liechtenstein",Luxemburg:"Luxembourg",Palestinian_Territories:"Palestinian_Territories",Gasconage__MO:"Gasconade__MO",Fairbanks_North_Stark__AK:"Fairbanks_North_Star__AK",La_Salle__LA:"LaSalle__LA",Wade_Hampton__AK:"Kusilvak__AK",Albermarle__VA:"Albemarle__VA",Donough__IL:"McDonough__IL",Onodaga__NY:"Onondaga__NY",Grand__SD:"Grant__SD",MAtera:"Matera",Moldavia:"Moldova",Tynisia:"Tunisia",Czech_Republic:"Czechia"};return e[t]&&(t=e[t]),t}function X(t){if(/^#[0-9A-F]{6}$/i.test(t))return t;function e(t){return("0"+parseInt(t).toString(16)).slice(-2)}return"#"+e((t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+e(t[2])+e(t[3])}function U(){tt();var t=.5<$("#backgroundpicker").spectrum("get").toHsl().l?"#000":"#fff",e=self.URL||self.webkitURL||self,a=$("#canvas1").attr("height")-conf.img2y;if(W){var r=50+5*conf.legendFactor,i=55+5*conf.legendFactor,n=26+3*conf.legendFactor,l=61+5*conf.legendFactor,o=0,s=0,c=90+5*conf.legendFactor,d=20+5*conf.legendFactor,f="",h='<text x="30" y="90" fill="'+t+'" font-size="'+i+'" font-weight="bold" overflow="hidden" font-family="Century Gothic,Segoe UI,Lucida Grande,sans-serif">',p=0,g=et($("#mapTitleInput").val().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n+1);if(null===g)h+='<tspan x="30" dy="0"> </tspan>',o+=1;else for(var u=0;u<g.length;u++)h+='<tspan x="30" dy="'+p+'">'+g[u]+"</tspan>",p=c-d,o+=1,s+=1;f+=h+="</text>";for(var m="",b=0,v=1;v<=Object.keys(J).length;v++){var w=$("table tr:eq("+v+") > td:eq(0) > div:eq(0)"),k=80+o*c-s*d,y='<rect style="fill:'+(w.attr("data-patternId")?Y(w.attr("data-patternId")):X(w.css("background-color")))+';opacity:1;color:#000000;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-opacity:1;" width="'+l+'" height="'+l+'" x="10" y="'+k+'" />',x=$("table tr:eq("+v+") > td:eq(1) input").val().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),P='<text x="120" y="'+(b=45+5*conf.legendFactor+k)+'" fill="'+t+'" font-size="'+r+'" overflow="hidden" font-family="Century Gothic,Segoe UI,Lucida Grande,sans-serif">';if(p=0,null===(g=et(x,n)))P+='<tspan x="120" dy="0"> </tspan>',o+=1;else for(var S=0;S<g.length;S++)P+='<tspan x="120" dy="'+p+'">'+g[S]+"</tspan>",p=c-d,o+=1,0!==S&&(s+=1);m+=y,m+=P+="</text>"}var _=300+b-a;if(0<_){var O=parseInt($("#canvas1").attr("height")),C=parseInt($("#map").attr("height").match(/\d+/)[0]),L=_/(O/C);$("#canvas1").attr("height",O+_),$("#map").attr("height",C+L)}else _=0;var I=Q.map(function(t){return t.replace("userSpaceOnUse",'userSpaceOnUse" patternTransform="scale(2)')}),U='<svg xmlns="http://www.w3.org/2000/svg" width="'+conf.svgWidth+'" height="5000px" ><defs>'+I.join("")+"</defs>"+f+m+"</svg>",A="data:image/svg+xml,"+U,M=new Image;if($.browser.mozilla){var T=new Blob([U],{type:"image/svg+xml;charset=utf-8"}),z=e.createObjectURL(T);M.src=z}else M.src=A}var R=(new XMLSerializer).serializeToString(document.querySelector("#map")),N="data:image/svg+xml,"+R,F=document.getElementById("canvas1"),H=F.getContext("2d"),D=new Image;if($.browser.mozilla){var E=new Blob([R],{type:"image/svg+xml;charset=utf-8"}),G=e.createObjectURL(E);D.src=G}else D.src=N;var B='<svg xmlns="http://www.w3.org/2000/svg" width="2000" height="150"><text x="90" y="50" fill="'+t+'" font-size="'+(32+5*conf.legendFactor)+'" font-weight="bold" overflow="hidden" font-family="Century Gothic,Segoe UI,Lucida Grande">Created with '+Z+" &#169; </text></svg>",V="data:image/svg+xml,"+B,j=new Image;if($.browser.mozilla){var K=new Blob([B],{type:"image/svg+xml;charset=utf-8"}),q=e.createObjectURL(K);j.src=q}else j.src=V;D.onload=function(){H.fillStyle=$("#backgroundpicker").spectrum("get").toString(),H.fillRect(0,0,F.width,F.height),H.drawImage(D,0,0,F.width,F.height),W&&H.drawImage(M,conf.img2x,conf.img2y),H.drawImage(j,conf.img3x,conf.img3y+_)};F.toDataURL("image/png");$("#canvas1, #map, #info").toggle(),$("#edit").prop("disabled",!1),$("#convert, #clear, #downup").prop("disabled",!0).css("color","#fff"),$("#download").toggle("slow")}function tt(){for(var t=0;t<l.length;t++){var e=l[t];$("#"+e).toggle()}}function et(t,e){return t.match(RegExp(".{1,"+e+"}(\\s|$)","g"))}return $(window).on("load",function(){$(".loader").fadeOut("very slow")}),jQuery.fn.outerHTML=function(){return jQuery("<div />").append(this.eq(0).clone()).html()},$(document).ready(function(){!function(){$("#map>path").click(function(t){k($(t.target))}),$("#map>path").mouseover(function(t){!function(t){if(P(t)){var e=document.getElementById(t);e.setAttribute("stroke-width",conf.mouseoverStroke),$("#info").html($(e).attr("id").replace(/_/g," "))}}(t.target.id)}),$("#map>path").mouseout(function(t){var e;P(e=t.target.id)&&(document.getElementById(e).setAttribute("stroke-width",conf.mouseoutStroke),$("#info").html("-"))}),$("#convert").click(function(){U()}),$("#download").click(function(){var t,e,a;t=this,e=function(t){for(var e=t.split(","),a=e[0].match(/:(.*?);/)[1],r=atob(e[1]),i=r.length,n=new Uint8Array(i);i--;)n[i]=r.charCodeAt(i);return new Blob([n],{type:a})}(document.getElementById("canvas1").toDataURL("image/png")),a=URL.createObjectURL(e),t.download=$("#mapTitleInput").val(),t.href=a}),$("#download, #undo-clear").toggle(),$("#edit").click(function(){!function(){tt(),$("#canvas1").hide(),$("#map").show(),$("#info").show();var t=document.getElementById("canvas1");t.getContext("2d").clearRect(0,0,t.width,t.height),O(),$("#edit").prop("disabled",!0),$("#edit").css("color","white"),$("#convert, #clear, #downup").prop("disabled",!1),$("#download").toggle("slow")}()}),$("#clear").click(function(t){x()}),$("#undo-clear").click(function(t){L(JSON.parse(s)),$("#undo-clear").toggle("slow")}),$("#disableLegend").click(function(){var t;t=this,W?($("#ltable").css("opacity",.3),$(t).removeClass("btn-newC icon-close").addClass("btn-newA icon-enable").html("ENABLE"),W=!1):($("#ltable").css("opacity",1),$(t).removeClass("btn-newA icon-enable").addClass("btn-newC icon-close").html("DISABLE"),W=!0)}),$("#upload").click(function(){x(),$("#undo-clear").hide(),L(JSON.parse($("#uploadData").val())),$("#undo-clear").show(),$("#uploadModal").hide()}),$("#isolateState").click(function(){isolateState($("#stateToIsolate").val())}),$("#restoreAllStates").click(function(){restoreAllStates()}),$("#startZoom").click(function(){$("#showSvgControls, #svgControls").toggle(),$("#mapContainer").css("border","1px dashed #f78f1e"),zoomTool=new $.SvgZoomer($("#map"))}),$("#exitZoom").click(function(){$("#showSvgControls, #svgControls").toggle(),$("#mapContainer").css("border",""),zoomTool.stop()}),$("#resetZoom").click(function(){$("#showSvgControls, #svgControls").toggle(),$("#mapContainer").css("border",""),zoomTool.reset()}),$("#legendplace").sortable(),$("#link").click(function(){var t=C();this.href="data:text/plain;charset=utf-8,"+encodeURIComponent(t)}),$("#no-borders").change(function(){this.checked?$("#map>path").each(function(){P(this.id)&&$(this).css("stroke",$("#borderpicker").val())}):$("#map>path").each(function(){P(this.id)&&$(this).css("stroke",$(this).css("fill"))})}),$("#show-states").change(function(){this.checked?$("#state_abbr, #state_lines").show():$("#state_abbr, #state_lines").hide()}),$("#isolateFromList").click(function(){$("#isolate-alert").html("");var e=$("#listToIsolate").val().toUpperCase().split(",");e=$.map(e,$.trim);var a=[];$("#map>path").each(function(){var t=this.id.slice(-2);-1===a.indexOf(t)&&a.push(t)});for(var t="",r=0,i=e.length;r<i;r++)-1===a.indexOf(e[r])&&(t+=e[r]+", ");0<t.length?(t=t.slice(0,-2),$("#isolate-alert").append("<p><em>"+t+"</em> are not valid. Please input valid, comma-separated values.").show()):($("#map>path").each(function(){var t=this.id.slice(-2);-1===e.indexOf(t)&&$(this).hide()}),$("#isolateFromList").prop("disabled",!0).css("color","#fff"),$("#showAll").prop("disabled",!1).css("color","#fff"),$("#isolate-alert").hide())}),$("#showAll").click(function(){$("#map>path").each(function(){$(this).show()}),$("#isolateFromList").prop("disabled",!1).css("color","#fff"),$("#showAll").prop("disabled",!0).css("color","#fff"),$("#isolate-alert").hide()}),conf.originalSVGH=parseInt($("#map").attr("height").match(/\d+/)[0]),$("#mapTitleInput").keydown(function(t){13==t.which&&t.preventDefault()}),$.browser.msie&&(-1!==n.indexOf(i)?$("#colorPickers").prepend('<p><span class="label label-danger"><i class="fa fa-bullhorn"></i> Internet Explorer/Edge not supported. Please use another browser. </span></p>'):$("#img-title").append('<p><span class="label label-danger"><i class="fa fa-bullhorn"></i> Internet Explorer/Edge not supported. Please use another browser. </span></p>'));$("#fillpicker").spectrum({color:"#cc3333",showInput:!0,showPalette:!0,palette:c,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"fillpicker-container",show:function(t){for(var e in J)$('.fillpicker-container .sp-palette-container span.sp-thumb-el[title="'+e+'"]').addClass("sp-thumb-active")}}),$("#fillpicker-form .sp-replacer .sp-preview").css("width",conf.fillBoxWidth),$("#backgroundpicker").spectrum({color:"#fff",showInput:!0,showPalette:!0,palette:c,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,showAlpha:!0,preferredFormat:"hex",change:function(t){$("#map").css("background-color",t)}}),$("#borderpicker").spectrum({color:"#000",showInput:!0,showPalette:!0,palette:c,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",change:function(t){$("#map>path").each(function(){P(this.id)&&$(this).css("stroke",t)})}}),$(".btn-new").mouseover(function(){$(this).css("color",$(this).css("background-color"))}).mouseout(function(){$(this).css("color","white")});var e=$(".navbar").height()+2;$(window).scroll(function(){var t=$(document).scrollTop();0<t?$("#info").css("top",0):$("#info").css("top",e+"px")}),$("#isolate-alert").hide(),$("#isolate-alert").on("closed.bs.alert",function(){$(this).html("")}),$.contextMenu({selector:"#map>path",className:"data-title",events:{show:function(t){$("#context-menu-layer").remove(),$(".data-title").attr("data-menutitle",t.$trigger.attr("id").replace(/_/g," ")),$("#bgPatternPicker").spectrum({color:h(t.$trigger.attr("id")).bg,showInput:!0,showPalette:!0,palette:c,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"botPatternPicker-container",change:function(t){p()},show:function(t){for(var e in J)$('.botPatternPicker-container .sp-palette-container span.sp-thumb-el[title="'+e+'"]').addClass("sp-thumb-active")}}),$("#topPatternPicker").spectrum({color:h(t.$trigger.attr("id")).top,showInput:!0,showPalette:!0,palette:c,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"topPatternPicker-container",change:function(t){p()},show:function(t){for(var e in J)$('.topPatternPicker-container .sp-palette-container span.sp-thumb-el[title="'+e+'"]').addClass("sp-thumb-active")}});var e=h(t.$trigger.attr("id")).pType;$(".selectedPattern select").val(e),t.inputs.patternSelect.selected=e,p(),function(e){for(var t=$("#legendplace>tr>td>div[data-patternId]").clone(),a=[],r=0,i=t.length;r<i;r++){var n=$(t[r]),l=n.prop("id").replace("box","usedPatternBox");n.prop({id:l}).addClass("used-pattern-box"),n.on("click",function(){var t=f($(this).attr("data-patternId"));v(e,t.pType,t.bg,t.top),$(e).contextMenu("hide")}),a.push(n)}$(".existing-patterns").html(a)}(t.$trigger)}},items:{removeColor:{name:"Remove Color",icon:"fa-eraser",callback:function(t,e){S(this)},disabled:function(t,e){var a=e.$trigger.attr("id"),r=e.$trigger.attr("fill");if(-1!==l.indexOf(a)||!P(a)||d(r)||r===o)return!0}},sep1:"---------",addPattern:{name:"Add/Modify Pattern",icon:"fa-th",className:"pattern-holder",items:{bgColor:{name:"                    ",type:"html",className:"",html:"<span>Background Color: </span> <input id='bgPatternPicker' type='text' class='form-control' />"},patternColor:{name:"                    ",type:"html",className:"",html:"<span>Pattern Color: </span> <input id='topPatternPicker' type='text' class='form-control' />"},patternSelect:{name:"Pattern Type: ",type:"select",className:"selectedPattern",selected:"circles3",options:{circles3:"Dots",diagonal1:"Diagonal Stripes Light",diagonal3:"Diagonal Stripes Thick",vertical1:"Vertical Stripes Light",vertical3:"Vertical Stripes Thick",horizontal1:"Horizontal Stripes Light",horizontal3:"Horizontal Stripes Thick",crosshatch:"Crosshatch",texture:"Texture",subtlepatch:"Subtle Patch",checkers:"Checkers",raindrops:"Raindrops"},events:{change:function(t){p()}}},sep4:"---------",preview:{name:"",type:"html",className:"preview-pattern",html:'<svg height="30" version="1.1" width="100" xmlns="http://www.w3.org/2000/svg" style="overflow: hidden;" id="previewPatternSVG"><defs></defs><rect class="previewPatternRect" height="30" width="100"></rect> </svg>'},sep5:"---------",confirmPattern:{name:"Paint with Pattern",className:"pattern-button",callback:function(t,e){var a=$(".selectedPattern select").val(),r=$("#bgPatternPicker").spectrum("get").toString(),i=$("#topPatternPicker").spectrum("get").toString();b(this,a,r,i)}}},disabled:function(t,e){var a=e.$trigger.attr("id");if(-1!==l.indexOf(a)||!P(a))return!0}},copyPattern:{name:"Copy Existing Pattern",icon:"fa-clone",className:"existing-patterns-menu",items:{existingPatterns:{name:"                    ",type:"html",html:"",className:"existing-patterns"}},disabled:function(t,e){var a=e.$trigger.attr("id");if(-1!==l.indexOf(a)||!P(a)||0===$("#legendplace>tr>td>div[data-patternId]").length)return!0}},removePattern:{name:"Remove Pattern",icon:"fa-square",callback:function(t,e){!function(t){var e=t[0].style,a=t[0].id;if(""===e.fill)return;var r=m(a),i=f(r);t.attr("fill",i.bg).css("fill",i.bg),w(i.bg,a),_(r,a)}(this)},disabled:function(t,e){var a=e.$trigger.attr("id"),r=e.$trigger.attr("fill");if(-1!==l.indexOf(a)||!P(a)||!d(r))return!0}},sep2:"---------",showPath:{name:"Show",icon:"fa-eye",callback:function(t,e){var a,r,i;r=(a=this)[0].style,i=a[0].id,a.attr("fill",o).css("fill",o),r.strokeDasharray="none",l.splice(l.indexOf(i),1)},disabled:function(t,e){var a=e.$trigger.attr("id");if(-1==l.indexOf(a)||!P(a))return!0}},hidePath:{name:"Hide",icon:"fa-eye-slash",callback:function(t,e){y(this)},disabled:function(t,e){var a=e.$trigger.attr("id");if(-1!==l.indexOf(a)||!P(a))return!0}},sep3:"---------",info:{name:"*Hidden elements will not appear on the final map.",className:"context-info",disabled:!0}}});for(var t=0,a=Q.length;t<a;t++){var r=$.parseHTML("<svg>"+Q[t]+"</svg>")[0].firstChild;$("#map defs").append(r)}}()}),{click:k,removeColor:S,deleteRow:function(t){var e=$(t).closest("tr").find("div"),a=e.attr("data-patternId")||X(e.css("background-color"));J[a].paths.forEach(function(t){$("#"+t).attr("fill",o).css("fill",o)}),r(a)},restoreConfig:L,convert:U,colors:J}}();